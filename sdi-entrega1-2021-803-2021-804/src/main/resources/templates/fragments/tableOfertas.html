<table class="table table-hover" th:fragment="tableOfertas"
	id="tableOfertas">
	<thead>
		<tr>
			<th th:text="#{oferta.id}" class="col-md-1">id</th>
			<th th:text="#{oferta.titulo}">Titulo</th>
			<th th:text="#{oferta.cantidad}">Cantidad (euros)</th>
			<th class="col-md-1"></th>
			<th class="col-md-1"></th>
			<th class="col-md-1"></th>
		</tr>
	</thead>
	<tbody>
		<tr th:each="oferta : ${ofertaList}">
			<td th:text="${oferta.id}">1</td>
			<td th:text="${oferta.titulo}">A</td>
			<td th:text="${oferta.cantidad}">10</td>
			<td><a th:href="${'/oferta/details/' + oferta.id}" th:text="#{oferta.detalles}">detalles</a></td>
			<td>
				<div th:if="${!oferta.comprada}">
					<div th:if="${!(oferta.user.id==session.usuario.id)}">
					<button type="button" th:id="${'buyButton' + oferta.id}" class="btn btn-info" th:text="#{oferta.comprar}">Comprar</button>
					<script th:inline="javascript">
						 /*<![CDATA[*/
						 $( "#buyButton[[${oferta.id}]]" ).click(function() {
							 $.get( "/oferta/[[${oferta.id}]]/comprar", function( data ) {
								 var numberPage = [[${param.page}]];
								 var urlUpdate = '/oferta/list';
								 if ( numberPage != null ){
								 	urlUpdate += "?page="+numberPage[0];
								 }						 
								 $("#lista").load(urlUpdate);
								 location.reload();
								if([[${oferta.cantidad}]] > [[${session.usuario.saldo}]]){
									 alert("Error al realizar la compra, saldo insuficiente.");
								}
							 });
						 });
						 /*]]>*/
					 </script> 
					 </div>
				</div>
			</td>
			<td th:if="${oferta.comprada}" th:text="#{oferta.vendida}"></td>
		</tr>
	</tbody>
</table>